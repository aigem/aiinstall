# {name} 安装配置
version: "1.0"
name: "{name}"
description: "{description}"

install:
  # 环境配置
  environments:
    ubuntu-a:
      base_dir: "/home/{user}/ai_apps/{name}"
      python_cmd: "python3"
      use_sudo: false
      pip_index: "https://pypi.org/simple"
      pip_timeout: 60
      pip_retries: 3
    github:
      base_dir: "/workspace"
      python_cmd: "python"
      use_sudo: false
      pip_index: "https://pypi.org/simple"
      pip_timeout: 60
      pip_retries: 3

# 安装步骤
steps:
  # 步骤1: 下载源码
  - name: "download"
    description: "下载应用源码"
    common:
      - "git clone {repo_url} {base_dir}"
      - "cd {base_dir}"
      - "git checkout {version}"

  # 步骤2: 安装依赖
  - name: "install"
    description: "安装应用依赖"
    common:
      - "{python_cmd} -m pip install -r requirements.txt"

  # 步骤3: 配置应用
  - name: "configure"
    description: "配置应用"
    common:
      - "mkdir -p {base_dir}/data"
      - "mkdir -p {base_dir}/logs"

# 启动配置
startup:
  description: "应用启动说明"
  port: 8188  # 可选：应用端口号
  commands:
    - "cd {base_dir}"
    - "source {venv_dir}/bin/activate"
    - "python src/main.py --port {port}"

  post_install_message: |
    {name} 安装完成！
    
    启动方式：
    1. 进入安装目录: cd {base_dir}
    2. 激活环境: source {venv_dir}/bin/activate
    3. 启动程序: python src/main.py --port {port}
    
    访问地址: http://localhost:{port}
    
    如需帮助，请参考文档：{docs_url} 